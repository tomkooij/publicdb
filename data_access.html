<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>1. Data access &mdash; Public Database 0.1 documentation</title>
    
    <link rel="stylesheet" href="_static/nature.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/hisparc_style.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="shortcut icon" href="_static/favicon.ico"/>
    <link rel="top" title="Public Database 0.1 documentation" href="index.html" />
    <link rel="next" title="2. API Tutorial" href="api_tutorial.html" />
    <link rel="prev" title="Public Database documentation!" href="index.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="api_tutorial.html" title="2. API Tutorial"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="index.html" title="Public Database documentation!"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">Public Database 0.1 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="data-access">
<h1>1. Data access<a class="headerlink" href="#data-access" title="Permalink to this headline">¶</a></h1>
<p>There are several ways in which the HiSPARC data can be accessed:</p>
<ul class="simple">
<li>Via the Public database Download Form</li>
<li>Via Python using the SAPPHiRE framework (see <a class="reference external" href="http://docs.hisparc.nl/sapphire/tutorial.html#downloading-and-accessing-hisparc-data">SAPPHiRE Tutorial</a>)</li>
</ul>
<p>On this page the second method is explained and examples are given. To
access metadata, like a list of all stations or information about a
specific station see the <a class="reference internal" href="api_tutorial.html"><em>API Tutorial</em></a>.</p>
<div class="section" id="download-form">
<h2>1.1. Download Form<a class="headerlink" href="#download-form" title="Permalink to this headline">¶</a></h2>
<p>When looking at the data page for a station (i.e. <a class="reference external" href="http://data.hisparc.nl/show/stations/202/">Kaj Munk College</a>), you will see a &#8216;Download
event summary data&#8217; link on the right. When this link is clicked you
will be taken to the <a class="reference external" href="http://data.hisparc.nl/data/download">Data Download Form</a>. On this page you can select
the station, the start and end date for which you want to download the
data. There is also an option to download weather data instead of events,
however, not all stations gather weather data.</p>
<p>When you click the Submit button without checking the checkbox to
Download, the data should (Firefox always download the data) show up in
your browser window. If you check the Download box the data will be
downloaded to your PC as a csv file. The filename will contain the
station number and the dates selected.</p>
<p>This csv file can be read by many programs, like Excel.</p>
</div>
<div class="section" id="downloading-via-python">
<h2>1.2. Downloading via Python<a class="headerlink" href="#downloading-via-python" title="Permalink to this headline">¶</a></h2>
<p>This is an example of how to download the data from the Public database
in Python. In this example we will download 1 hour of data for station
202 on July 2, 2013.</p>
<p>First load the required libraries (requires the numpy package).</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">urllib2</span> <span class="kn">import</span> <span class="n">urlopen</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">urllib</span> <span class="kn">import</span> <span class="n">urlencode</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">csv</span> <span class="kn">import</span> <span class="n">reader</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">StringIO</span> <span class="kn">import</span> <span class="n">StringIO</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">genfromtxt</span>
</pre></div>
</div>
<p>Then define the url and place the start and end datetime in the query.
To download weather data instead, replace &#8216;events&#8217; by &#8216;weather&#8217; in
the url (and choose a station that has weather data, e.g. 3 or 501).</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Do not pass the query to the urlopen &#8216;data&#8217; argument because that
changes the request into a <em>POST</em> request, but you need a <em>GET</em>
request.</p>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">url</span> <span class="o">=</span> <span class="s">&#39;http://data.hisparc.nl/data/202/events&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">start</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2013</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">end</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2013</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">query</span> <span class="o">=</span> <span class="n">urlencode</span><span class="p">({</span><span class="s">&#39;download&#39;</span><span class="p">:</span> <span class="bp">False</span><span class="p">,</span> <span class="s">&#39;start&#39;</span><span class="p">:</span> <span class="n">start</span><span class="p">,</span><span class="s">&#39;end&#39;</span><span class="p">:</span> <span class="n">end</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">full_url</span> <span class="o">=</span> <span class="n">url</span> <span class="o">+</span> <span class="s">&#39;?&#39;</span> <span class="o">+</span> <span class="n">query</span>
</pre></div>
</div>
<p>Download the data and store it in a variable</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">urlopen</span><span class="p">(</span><span class="n">full_url</span><span class="p">)</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
</pre></div>
</div>
<p>Now use numpy to convert the data from csv to a numpy array.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">format</span> <span class="o">=</span> <span class="p">[(</span><span class="s">&#39;date&#39;</span><span class="p">,</span> <span class="s">&#39;datetime64[D]&#39;</span><span class="p">),</span> <span class="p">(</span><span class="s">&#39;time&#39;</span><span class="p">,</span> <span class="s">&#39;|S8&#39;</span><span class="p">),</span>
<span class="go">              (&#39;timestamp&#39;, &#39;uint32&#39;), (&#39;nanoseconds&#39;, &#39;uint32&#39;),</span>
<span class="go">              (&#39;pulseheights&#39;, &#39;4int16&#39;), (&#39;integrals&#39;, &#39;4int16&#39;),</span>
<span class="go">              (&#39;n1&#39;, &#39;float32&#39;), (&#39;n2&#39;, &#39;float32&#39;),</span>
<span class="go">              (&#39;n3&#39;, &#39;float32&#39;), (&#39;n4&#39;, &#39;float32&#39;),</span>
<span class="go">              (&#39;t1&#39;, &#39;float32&#39;), (&#39;t2&#39;, &#39;float32&#39;),</span>
<span class="go">              (&#39;t3&#39;, &#39;float32&#39;), (&#39;t4&#39;, &#39;float32&#39;)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">genfromtxt</span><span class="p">(</span><span class="n">StringIO</span><span class="p">(</span><span class="n">data</span><span class="p">),</span> <span class="n">delimiter</span><span class="o">=</span><span class="s">&quot;</span><span class="se">\t</span><span class="s">&quot;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">format</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">(datetime.date(2013, 7, 2), &#39;11:00:02&#39;, 1372762802L, 466307811L,</span>
<span class="go"> [78, 798, -1, -1], [535, 10882, -1, -1],</span>
<span class="go"> 0.14720000326633453, 3.854599952697754, -1.0, -1.0,</span>
<span class="go"> 345.0, 12.5, -1.0, -1.0)</span>
</pre></div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/header.png" alt="Logo"/>
            </a></p>
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">1. Data access</a><ul>
<li><a class="reference internal" href="#download-form">1.1. Download Form</a></li>
<li><a class="reference internal" href="#downloading-via-python">1.2. Downloading via Python</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="index.html"
                        title="previous chapter">Public Database documentation!</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="api_tutorial.html"
                        title="next chapter">2. API Tutorial</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/data_access.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="api_tutorial.html" title="2. API Tutorial"
             >next</a> |</li>
        <li class="right" >
          <a href="index.html" title="Public Database documentation!"
             >previous</a> |</li>
        <li><a href="index.html">Public Database 0.1 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2013, HiSPARC.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2b1.
    </div>
  </body>
</html>